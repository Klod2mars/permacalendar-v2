{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://permacalendar.com/schemas/plants-v2.1.0.json",
  "title": "PermaCalendar Plants Database Schema",
  "description": "Schéma de validation pour la base de données des plantes de PermaCalendar v2.1.0",
  "type": "object",
  "required": [
    "schema_version",
    "metadata",
    "plants"
  ],
  "properties": {
    "schema_version": {
      "type": "string",
      "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$",
      "description": "Version du schéma (format semver: X.Y.Z)",
      "examples": ["2.1.0"]
    },
    "metadata": {
      "type": "object",
      "required": [
        "version",
        "updated_at",
        "total_plants",
        "source"
      ],
      "properties": {
        "version": {
          "type": "string",
          "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$",
          "description": "Version des données"
        },
        "updated_at": {
          "type": "string",
          "format": "date",
          "description": "Date de dernière mise à jour (YYYY-MM-DD)"
        },
        "total_plants": {
          "type": "integer",
          "minimum": 0,
          "description": "Nombre total de plantes dans la base"
        },
        "source": {
          "type": "string",
          "description": "Source des données"
        },
        "description": {
          "type": "string",
          "description": "Description de la base de données"
        },
        "migration_date": {
          "type": "string",
          "format": "date-time",
          "description": "Date de migration (si applicable)"
        },
        "migrated_from": {
          "type": "string",
          "description": "Format source de migration (si applicable)"
        }
      },
      "additionalProperties": true
    },
    "plants": {
      "type": "array",
      "minItems": 1,
      "description": "Liste des plantes",
      "items": {
        "type": "object",
        "required": [
          "id",
          "commonName",
          "scientificName",
          "family"
        ],
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^[a-z0-9_-]+$",
            "description": "Identifiant unique (slug)",
            "examples": ["tomato", "carrot", "lettuce"]
          },
          "commonName": {
            "type": "string",
            "minLength": 1,
            "description": "Nom commun de la plante",
            "examples": ["Tomate", "Carotte", "Laitue"]
          },
          "scientificName": {
            "type": "string",
            "minLength": 1,
            "description": "Nom scientifique (binomial)",
            "examples": ["Solanum lycopersicum", "Daucus carota", "Lactuca sativa"]
          },
          "family": {
            "type": "string",
            "minLength": 1,
            "description": "Famille botanique",
            "examples": ["Solanaceae", "Apiaceae", "Asteraceae"]
          },
          "sowingMonths": {
            "type": "array",
            "uniqueItems": true,
            "description": "Mois de semis recommandés (abréviations)",
            "items": {
              "type": "string",
              "enum": ["J", "F", "M", "A", "M", "J", "J", "A", "S", "O", "N", "D"],
              "description": "Mois (J=Janvier, F=Février, M=Mars, A=Avril, M=Mai, J=Juin, J=Juillet, A=Août, S=Septembre, O=Octobre, N=Novembre, D=Décembre)"
            }
          },
          "harvestMonths": {
            "type": "array",
            "uniqueItems": true,
            "description": "Mois de récolte recommandés (abréviations)",
            "items": {
              "type": "string",
              "enum": ["J", "F", "M", "A", "M", "J", "J", "A", "S", "O", "N", "D"]
            }
          },
          "daysToMaturity": {
            "type": "integer",
            "minimum": 1,
            "maximum": 365,
            "description": "Nombre de jours jusqu'à maturité"
          },
          "spacing": {
            "type": "number",
            "minimum": 0,
            "description": "Espacement recommandé en cm"
          },
          "depth": {
            "type": "number",
            "minimum": 0,
            "description": "Profondeur de semis en cm"
          },
          "sunExposure": {
            "type": "string",
            "enum": [
              "Plein soleil",
              "Mi-ombre",
              "Ombre",
              "Plein soleil/Mi-ombre"
            ],
            "description": "Exposition solaire requise"
          },
          "waterNeeds": {
            "type": "string",
            "enum": [
              "Faible",
              "Moyen",
              "Élevé",
              "Très élevé"
            ],
            "description": "Besoins en eau"
          },
          "description": {
            "type": "string",
            "description": "Description de la plante"
          },
          "marketPricePerKg": {
            "type": "number",
            "minimum": 0,
            "description": "Prix de marché moyen en €/kg"
          },
          "defaultUnit": {
            "type": "string",
            "enum": ["kg", "g", "unit", "bunch"],
            "description": "Unité par défaut pour les récoltes"
          },
          "nutritionPer100g": {
            "type": "object",
            "description": "Valeurs nutritionnelles pour 100g",
            "properties": {
              "energyKcal": { "type": "number", "minimum": 0 },
              "proteinG": { "type": "number", "minimum": 0 },
              "carbohydratesG": { "type": "number", "minimum": 0 },
              "sugarsG": { "type": "number", "minimum": 0 },
              "fatG": { "type": "number", "minimum": 0 },
              "fiberG": { "type": "number", "minimum": 0 },
              "vitaminCmg": { "type": "number", "minimum": 0 },
              "vitaminEmg": { "type": "number", "minimum": 0 },
              "vitaminB9ug": { "type": "number", "minimum": 0 },
              "potassiumMg": { "type": "number", "minimum": 0 },
              "magnesiumMg": { "type": "number", "minimum": 0 },
              "calciumMg": { "type": "number", "minimum": 0 }
            },
            "additionalProperties": true
          },
          "germination": {
            "type": "object",
            "description": "Informations de germination",
            "properties": {
              "minTemperature": {
                "type": "number",
                "description": "Température minimale de germination (°C)"
              },
              "optimalTemperature": {
                "type": "object",
                "properties": {
                  "min": { "type": "number" },
                  "max": { "type": "number" }
                },
                "required": ["min", "max"]
              },
              "germinationTime": {
                "type": "object",
                "properties": {
                  "min": { "type": "integer", "minimum": 1 },
                  "max": { "type": "integer", "minimum": 1 },
                  "unit": { "type": "string", "enum": ["jours", "semaines"] }
                },
                "required": ["min", "max", "unit"]
              }
            },
            "additionalProperties": true
          },
          "growth": {
            "type": "object",
            "description": "Informations de croissance",
            "properties": {
              "idealTemperature": {
                "type": "object",
                "properties": {
                  "min": { "type": "number" },
                  "max": { "type": "number" }
                }
              },
              "minTemperature": {
                "type": "number",
                "description": "Température minimale de croissance (°C)"
              },
              "maxTemperature": {
                "type": "number",
                "description": "Température maximale tolérée (°C)"
              }
            },
            "additionalProperties": true
          },
          "watering": {
            "type": "object",
            "description": "Informations d'arrosage",
            "properties": {
              "frequency": { "type": "string" },
              "amount": { "type": "string" },
              "method": { "type": "string" },
              "bestTime": { "type": "string" }
            },
            "additionalProperties": true
          },
          "thinning": {
            "type": "object",
            "description": "Informations d'éclaircissage",
            "properties": {
              "distance": { "type": "string" },
              "when": { "type": "string" }
            },
            "additionalProperties": true
          },
          "weeding": {
            "type": "object",
            "description": "Informations de désherbage",
            "properties": {
              "method": { "type": "string" },
              "frequency": { "type": "string" },
              "recommendation": { "type": "string" }
            },
            "additionalProperties": true
          },
          "culturalTips": {
            "type": "array",
            "description": "Conseils de culture",
            "items": {
              "type": "string"
            }
          },
          "biologicalControl": {
            "type": "object",
            "description": "Contrôle biologique des maladies/ravageurs",
            "properties": {
              "preparations": {
                "type": "array",
                "items": { "type": "string" }
              },
              "beneficialInsects": {
                "type": "array",
                "items": { "type": "string" }
              },
              "companionPlants": {
                "type": "string"
              }
            },
            "additionalProperties": true
          },
          "harvestTime": {
            "type": "string",
            "description": "Temps jusqu'à récolte (description textuelle)"
          },
          "companionPlanting": {
            "type": "object",
            "description": "Plantes compagnes",
            "properties": {
              "beneficial": {
                "type": "array",
                "description": "Plantes bénéfiques (associations positives)",
                "items": { "type": "string" }
              },
              "avoid": {
                "type": "array",
                "description": "Plantes à éviter (associations négatives)",
                "items": { "type": "string" }
              }
            },
            "additionalProperties": false
          },
          "frostSensitive": {
            "type": "boolean",
            "description": "Plante sensible au gel"
          },
          "heatTolerant": {
            "type": "boolean",
            "description": "Plante tolérante à la chaleur"
          },
          "metadata": {
            "type": "object",
            "description": "Métadonnées additionnelles spécifiques à la plante",
            "additionalProperties": true
          }
        },
        "additionalProperties": true
      }
    }
  },
  "additionalProperties": false
}
