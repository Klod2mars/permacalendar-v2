meta:
  project_name: IAMcoder
  description: "Test yaml_apply : détecte et insère insetPadding après return AlertDialog("
  version: "1.0"

context:
  mode: write_enabled

tasks:
  - name: test_yaml_apply_dryrun
    goal: "Dry-run: détecter le point d'insertion via regex et lister les matches (sans écrire)"
    task_type: yaml_apply
    parameters:
      instructions:
        replacements:
          - file: "lib/features/planting/presentation/dialogs/create_planting_dialog.dart"
            anchor_pattern: "^\\s*return AlertDialog\\("
            anchor_regex: true
            case_insensitive: false
            multiline: true
            dotall: false
            after: |
              \n  insetPadding: EdgeInsets.only(
                left: 24.0,
                right: 24.0,
                top: 24.0,
                bottom: MediaQuery.of(context).viewInsets.bottom + 24.0,
              ),
            include_anchor: true
            replace_all: false
      dry_run: true
      create_backup: false
      output: "reports/last_report.json"

  - name: apply_yaml_apply_live
    goal: "Application LIVE : insérer insetPadding et créer une sauvegarde"
    task_type: yaml_apply
    parameters:
      instructions:
        replacements:
          - file: "lib/features/planting/presentation/dialogs/create_planting_dialog.dart"
            anchor_pattern: "^\\s*return AlertDialog\\("
            anchor_regex: true
            multiline: true
            after: |
              \n  insetPadding: EdgeInsets.only(
                left: 24.0,
                right: 24.0,
                top: 24.0,
                bottom: MediaQuery.of(context).viewInsets.bottom + 24.0,
              ),
            include_anchor: true
            replace_all: false
      dry_run: false
      create_backup: true
      output: "reports/last_report.json"
