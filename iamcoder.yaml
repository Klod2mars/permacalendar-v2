meta:
  project_name: IAMcoder
  description: "Insert insetPadding after AlertDialog (safe block scalar)"
  version: "1.0"

context:
  mode: write_enabled

tasks:
  - name: dry_run_insert_insetpadding
    goal: "Dry-run: find insertion point (regex) and preview"
    task_type: yaml_apply
    parameters:
      instructions:
        replacements:
          - file: "lib/features/planting/presentation/dialogs/create_planting_dialog.dart"
            # regex matching the line possibly indented
            anchor_pattern: "^\\s*return AlertDialog\\("
            anchor_regex: true
            multiline: true
            dotall: false
            # Here use a YAML block to represent the lines to insert (very safe)
            after: |
              insetPadding: EdgeInsets.only(
                left: 24.0,
                right: 24.0,
                top: 24.0,
                bottom: MediaQuery.of(context).viewInsets.bottom + 24.0,
              ),
            include_anchor: true
            replace_all: false
      dry_run: true
      output: "reports/last_report.json"

  - name: apply_insert_insetpadding
    goal: "Live: insert insetPadding and create backup"
    task_type: yaml_apply
    parameters:
      instructions:
        replacements:
          - file: "lib/features/planting/presentation/dialogs/create_planting_dialog.dart"
            anchor_pattern: "^\\s*return AlertDialog\\("
            anchor_regex: true
            multiline: true
            after: |
              insetPadding: EdgeInsets.only(
                left: 24.0,
                right: 24.0,
                top: 24.0,
                bottom: MediaQuery.of(context).viewInsets.bottom + 24.0,
              ),
            include_anchor: true
            replace_all: false
      dry_run: false
      create_backup: true
      output: "reports/last_report.json"
