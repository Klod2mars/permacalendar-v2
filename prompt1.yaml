name: add-intelligence-state
description: Add domain IntelligenceState and import it into the provider.
steps:
  - name: add_entity
    run: |
      git apply -p0 <<'PATCH'
      *** Begin Patch
      *** Add File: lib/features/plant_intelligence/domain/entities/intelligence_state.dart
      +import '../../domain/entities/plant_condition.dart';
      +import '../../domain/entities/recommendation.dart';
      +import '../../domain/entities/garden_context.dart';
      +import '../../domain/entities/weather_condition.dart';
      +
      +class IntelligenceState {
      +  final String? currentGardenId;
      +  final bool isInitialized;
      +  final bool isAnalyzing;
      +  final Map<String, PlantCondition> plantConditions;
      +  final Map<String, List<Recommendation>> plantRecommendations;
      +  final List<String> activePlantIds;
      +  final GardenContext? currentGarden;
      +  final WeatherCondition? currentWeather;
      +  final DateTime? lastAnalysis;
      +  final String? error;
      +
      +  const IntelligenceState({
      +    this.currentGardenId,
      +    this.isInitialized = false,
      +    this.isAnalyzing = false,
      +    Map<String, PlantCondition>? plantConditions,
      +    Map<String, List<Recommendation>>? plantRecommendations,
      +    List<String>? activePlantIds,
      +    this.currentGarden,
      +    this.currentWeather,
      +    this.lastAnalysis,
      +    this.error,
      +  })  : plantConditions = plantConditions ?? const {},
      +        plantRecommendations = plantRecommendations ?? const {},
      +        activePlantIds = activePlantIds ?? const [];
      +
      +  IntelligenceState copyWith({ /* same signature as earlier */ }) {
      +    return IntelligenceState(
      +      currentGardenId: currentGardenId ?? this.currentGardenId,
      +      isInitialized: isInitialized ?? this.isInitialized,
      +      isAnalyzing: isAnalyzing ?? this.isAnalyzing,
      +      plantConditions: plantConditions ?? Map.from(this.plantConditions),
      +      plantRecommendations: plantRecommendations ?? Map.from(this.plantRecommendations),
      +      activePlantIds: activePlantIds ?? List.from(this.activePlantIds),
      +      currentGarden: currentGarden ?? this.currentGarden,
      +      currentWeather: currentWeather ?? this.currentWeather,
      +      lastAnalysis: lastAnalysis ?? this.lastAnalysis,
      +      error: error ?? this.error,
      +    );
      +  }
      +}
      +
      *** End Patch
      PATCH

  - name: import_in_provider
    run: |
      git apply -p0 <<'PATCH'
      *** Begin Patch
      *** Update File: lib/features/plant_intelligence/presentation/providers/intelligence_state_providers.dart
      @@
       import 'dart:developer' as developer;
       import 'package:riverpod/riverpod.dart';
      +import '../../domain/entities/intelligence_state.dart';
      *** End Patch
      PATCH

  - name: quick_checks
    run: |
      flutter pub get || true
      flutter analyze || true
